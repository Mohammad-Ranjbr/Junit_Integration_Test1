# SpringBootRestService

## Introduction
**Project Name:** SpringBootRestService

**Project Goal:** Conduct unit and integration tests in a Spring Boot project.

## Prerequisites
- **Java version:** 17
- **Maven version:** 4.0.0
- **Spring Boot version:** 3.2.5

## Installation and Setup

### Clone the Repository
```bash
git clone https://github.com/Mohammad-Ranjbr/Junit_Integration_Test1.git
cd Junit_Integration_Test1
```

## Build and Run with Maven
```bash
mvn clean install
mvn spring-boot:run
```

## Configuration
The `application.properties` file contains various settings for the application.

### General Information
```properties
spring.application.name=SpringBootRestService
```
**spring.application.name:** The name of the Spring Boot application is SpringBootRestService.

### Server Settings
```properties
server.address=127.0.0.1
server.port=8080
```
**server.address:** The server address points to localhost.

**server.port:** The port the server listens on.

### Database Settings
```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/SpringBootRestService?characterEncoding=UTF-8
spring.datasource.username=postgres
spring.datasource.password=123456
spring.datasource.driver-class-name=org.postgresql.Driver
spring.test.database.replace=none
```
**spring.datasource.url:** JDBC URL for connecting to the PostgreSQL database. The database is named SpringBootRestService, running on localhost at port 5432.

**spring.datasource.username:** The username for connecting to the database.

**spring.datasource.password:** The password for connecting to the database.

**spring.datasource.driver-class-name:** The JDBC driver class name for PostgreSQL.

**spring.test.database.replace:** Use the real database in tests without replacing it.

### Hibernate Settings
```properties
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
```
**spring.jpa.show-sql:** Show the SQL generated by Hibernate in the logs.

**spring.jpa.hibernate.ddl-auto:** Automatically update the database schema based on JPA models.

**spring.jpa.properties.hibernate.format_sql:** Format the SQL for readability.

**spring.jpa.properties.hibernate.dialect:** Use the PostgreSQL dialect for Hibernate.

### Logging Settings
```properties
logging.file.name=log/application.log
```

**logging.file.name:** The path to the log file where application logs are stored.

### Profile Settings
```properties
spring.profiles.active=dev
```

**spring.profiles.active:** The active profile for the application, which is set to 'dev' (development).

## Configuration: application-dev.properties

### Description:
The `application-dev.properties` file contains configuration settings specific to the development environment.

### Database Settings
```properties
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
```
**spring.datasource.url:** JDBC URL for connecting to the H2 in-memory database (mem:testdb).

**spring.datasource.driverClassName:** JDBC driver class name for H2.

**spring.datasource.username:** Username for database connection.

**spring.datasource.password:** Password for database connection (empty here).

### Hibernate Settings
```properties
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
```
**spring.jpa.database-platform:** Using H2 dialect for Hibernate.

### Initial SQL Settings
```properties
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:schema.sql
spring.sql.init.data-locations=classpath:data.sql
```

**spring.sql.init.mode:** Always execute initial SQL scripts.

**spring.sql.init.schema-locations:** Location of schema creation script file.

**spring.sql.init.data-locations:** Location of data script file.

## Usage
To use the application, follow the installation and setup steps. Once the application is running, you can interact with it using the defined endpoints.

### Example Requests and Responses
You can interact with the application using the following API endpoints:

#### Add Book
- **Endpoint:** `/api/v1/addBook`
- **Method:** `POST`
- **Description:** Adds a new book to the library.
- **Example Request Body:**
```json
{
  "isbn": "978-3-16-148410-0",
  "aisle": "A101",
  "name": "Sample Book",
  "author": "John Doe"
}
```
- **Example Response:**
 ```json
{
  "id": "978-3-16-148410-0A101",
  "message": "Book Added Successfully"
}
```

#### Get Book by ID
- **Endpoint:** `/api/v1/getBooks/{id}`
- **Method:** `GET`
- **Description:** Retrieves book details by ID.
- **Example Request:** `/api/v1/getBooks/978-3-16-148410-0A101`

#### Get Books by Author Name
- **Endpoint:** `/api/v1/getBooks/author/{authorName}`
- **Method:** `GET`
- **Description:** Retrieves books by author name.
- **Example Request:** `/api/v1/getBooks/author/John Doe`

#### Update Book
- **Endpoint:** `/api/v1/updateBook/{id}`
- **Method:** `PUT`
- **Description:** Updates details of an existing book.
- **Example Request Body:**
```json
{
  "aisle": "B202",
  "name": "Updated Sample Book",
  "author": "Jane Smith"
}
```

#### Delete Book by ID
- **Endpoint:** `/api/v1/deleteBook/{id}`
- **Method:** `DELETE`
- **Description:** Deletes a book by ID.
- **Example Request:** `/api/v1/deleteBook/978-3-16-148410-0A101`

#### Delete Book by Request Body
- **Endpoint:** `/api/v1/deleteBook`
- **Method:** `DELETE`
- **Description:** Deletes a book using request body.
- **Example Request Body:**
```json
{
  "id": "978-3-16-148410-0A101"
}
```

## Testing
To run the tests, follow the commands below:

1. **Start the Spring Boot Server:**
```bash
mvn spring-boot:run
```

### Start the Spring Boot with custom profile:
```bash
mvn spring-boot:run -Dspring-boot.run.profiles=dev
```
### Add profile in pom.xml file 
```properties
<profiles>
	<profile>
		<id>dev</id>
		<properties>
			<activatedProperties>dev</activatedProperties>
		</properties>
	</profile>
</profiles>
```

### In application.properties file:
```properties
spring.profiles.active=@activatedProperties@
```

### Run Unit Tests:
```bash
mvn test
```

### Run only Integrated Tests:
```bash
mvn failsafe:integration-test
```

### Add plugin in pom.xml file 
```properties
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-failsafe-plugin</artifactId>
    <version>2.17</version>
    <executions>
        <execution>
            <id>integration-tests</id>
            <goals>
                <goal>integration-test</goal>
                <goal>verify</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

### Run all Tests:
```bash
mvn integration-test
```

## Contribution
To contribute to the project, you can report issues or submit feature requests.

### Reporting Issues
For reporting issues, please email me with the project name (SpringBootRestService) in the title.

**Email:** mohammadranjbar.mmr81@gmail.com

## Authors
**Mohammad Ranjbar**